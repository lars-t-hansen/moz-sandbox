;;; -*- mode: scheme -*-

(defmodule wabbit

  (defclass Node
    (left  Node)
    (right Node))

 (defun+ (wabbit (n i32) -> Node)
   (if (= n 0)
       (null Node)
       (new Node (wabbit (- n 1)) (wabbit (- n 1)))))

 (defun+ (count (t Node) -> i32)
   (if (null? t)
       0
       (+ 1 (count (*left t)) (count (*right t)))))

 (defun+ (swap (t Node))
   (if (not (null? t))
       (let ((tmp (*left t)))
	 (set! (*left t) (*right t))
	 (set! (*right t) tmp)))))
