;;; -*- mode: scheme -*-

(module fib

 (func+ (run (n i32))
	(pri32 (fib n)))

 (func (fib (n i32) -> i32)
       (if (< n 2)
	   n
	   (+ (fib (- n 1)) (fib (- n 2)))))

 (func- (pri32 (n i32))))

(js "
var ans;
var ins = new WebAssembly.Instance(fib, {'': {pri32: (x) => ans=x}});
ins.exports.run(10);
assertEq(ans, 55);
")
